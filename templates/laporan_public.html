<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Laporan Keuangan Publik Posyandu Anggrek 14 Pangauban Silih Asih RW 14 Desa Pangauban Kecamatan Batujajar</title>

  <style>
    /* =========================
       Modern Premium Theme (Sama seperti index.html)
       ========================= */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap');

    :root{
      --bg-1: #0f172a;
      --grad-a: #05a3a2;
      --grad-b: #2563eb;
      --accent: #ff7a59;
      --muted: #94a3b8;
      --card-blur: 10px;
      --glass-border: rgba(255,255,255,0.06);
      --glass-strong: rgba(255,255,255,0.08);
      --radius-lg: 16px;
      --shadow-1: 0 8px 30px rgba(2,6,23,0.6);
      --transition: 360ms cubic-bezier(.2,.9,.2,1);
      color-scheme: dark;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(5,163,162,0.12), transparent 8%),
                  radial-gradient(1000px 500px at 90% 90%, rgba(37,99,235,0.12), transparent 6%),
                  linear-gradient(180deg, var(--bg-1), #061026 70%);
      color: #e6eef8;
      padding: 36px;
      overflow-x:hidden;
    }

    body::before{
      content:"";
      position:fixed; inset:0;
      background: linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
      background-size: 60px 60px;
      pointer-events:none;
      mix-blend-mode:overlay;
      opacity:0.5;
      animation: bgShift 12s linear infinite;
    }
    @keyframes bgShift { from{transform:translateX(0)} to{transform:translateX(-60px)} }

    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      max-width:1250px;
      margin: 0 auto 28px;
    }
    .title{
      display:flex; gap:14px; align-items:center;
    }
    .logo{
      width:56px; height:56px;
      border-radius:12px;
      background: linear-gradient(135deg,var(--grad-a),var(--grad-b));
      display:grid; place-items:center;
      font-weight:700; font-size:20px; color:white;
    }
    h1{margin:0; font-size:1.25rem; color:#f1f8ff;}
    .sub{color:var(--muted); font-size:0.9rem; margin-top:2px;}

    .container{
      max-width:1250px; margin:0 auto;
      display:grid; grid-template-columns:1fr;
      gap:22px;
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      border-radius: var(--radius-lg);
      padding:18px;
      box-shadow: var(--shadow-1);
      border:1px solid var(--glass-border);
      backdrop-filter: blur(var(--card-blur));
      transition: transform var(--transition);
    }
    .card:hover{
      transform: translateY(-6px);
      border-color: var(--glass-strong);
    }

    .summary{
      display:grid;
      grid-template-columns: repeat(3,1fr);
      gap:12px;
    }
    .stat{padding:16px; border-radius:12px; border:1px solid rgba(255,255,255,0.04);}
    .label{font-size:0.85rem;color:var(--muted);}
    .amount{font-size:1.45rem;font-weight:800;color:#fff;}
    .mini{font-size:0.78rem;color:var(--muted);}

    table{
      width:100%; border-collapse:collapse; min-width:800px;
    }
    th{
      padding:10px; text-align:center; font-size:0.9rem;
      border-bottom:1px solid rgba(255,255,255,0.05);
    }
    td{
      padding:10px; text-align:left; font-size:0.9rem;
      border-bottom:1px solid rgba(255,255,255,0.05);
    }
    th{background:rgba(8,12,20,0.6);}
    tr:hover{background:rgba(37,99,235,0.06);}

    .print-btn{
      background: linear-gradient(90deg,var(--accent), #ff9a74);
      color:#061026;
      padding:12px 16px;
      border-radius:12px;
      border:none;
      font-weight:700;
      cursor:pointer;
    }

    /* ====== TANDA TANGAN FULL WIDTH ====== */
    .ttd-section{
      margin-top:22px;
      display:flex;
      gap:20px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .ttd{
      flex:1 1 220px;
      text-align:center;
      color:var(--muted);
      font-size:0.9rem;
    }
    .ttd img{
      width:120px;
      border-radius:8px;
      margin-bottom:8px;
      filter: drop-shadow(0 8px 30px rgba(2,6,23,0.5));
    }



   
/* Tablet */
@media(max-width:768px){
  body{padding:20px;}
  
}

/* HP */
@media(max-width:480px){
  body{padding:14px;}
  
  .table-wrap{
    overflow-x:auto;
    -webkit-overflow-scrolling:touch;
    scrollbar-width: thin;
    scrollbar-color: rgba(255,255,255,0.2) transparent;
  }
  .table-wrap::-webkit-scrollbar {
    height: 8px;
  }
  .table-wrap::-webkit-scrollbar-thumb {
    background: rgba(255,255,255,0.2);
    border-radius: 10px;
  }
}

/* Cetak */
@media print {
  body{background:#fff;color:#000;padding:0;}
  header,.print-btn{display:none;}
  .card{box-shadow:none;background:transparent;}
  th{background:#e6eef8;color:#001;}
  td{color:#001;}
}

/* ====== ANIMASI ====== */
.fade-in-up{opacity:0;transform:translateY(6px);animation:fadeUp .6s ease forwards;}
@keyframes fadeUp{to{opacity:1;transform:translateY(0);}}
  </style>
</head>
<body>
  <header class="fade-in-up">
    <div class="title">
      <div class="logo">A14</div>
      <div>
        <h1>Laporan Keuangan ‚Äî Posyandu Anggrek 14 RW 14</h1>
        <div class="sub">Laporan Keuangan Posyandu Anggrek 14 Pangauban Silih Asih RW 14 Desa Pangauban Kecamatan Batujajar</div>
      </div>
    </div>
    <div class="sub">Status: <strong style="color:#c7f8f6">Publik</strong></div>
  </header>

  <main class="container">
    <section class="card fade-in-up">
      <div class="summary">
        <div class="stat">
          <div class="label">Total Masuk</div>
          <div class="amount" id="totalMasuk">Rp {{ "{:,.0f}".format(total_masuk) }}</div>
          <div class="mini">Jumlah keseluruhan pemasukan</div>
        </div>
        <div class="stat">
          <div class="label">Total Keluar</div>
          <div class="amount" id="totalKeluar">Rp {{ "{:,.0f}".format(total_keluar) }}</div>
          <div class="mini">Jumlah keseluruhan pengeluaran</div>
        </div>
        <div class="stat">
          <div class="label">Saldo Akhir</div>
          <div class="amount" id="saldoAkhir">Rp {{ "{:,.0f}".format(saldo_akhir) }}</div>
          <div class="mini">Saldo akhir periode</div>
        </div>
      </div>
    </section>

    <section class="card fade-in-up">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
        <input id="search" placeholder="Cari tanggal, keterangan..." style="padding:8px 10px;border-radius:8px;border:none;background:rgba(255,255,255,0.1);color:white;width:250px;">
        <button class="print-btn" onclick="window.print()">üñ®Ô∏è Cetak / Simpan PDF</button>
      </div>

      <div style="overflow-x:auto;">
        <table id="laporanTable">
          <thead>
            <tr>
              <th>No</th>
              <th>Tanggal</th>
              <th>Keterangan</th>
              <th>Masuk</th>
              <th>Keluar</th>
              <th>Saldo</th>
            </tr>
          </thead>
          <tbody>
            {% for row in data %}
            <tr>
              <td>{{ loop.index }}</td>
              <td>{{ row.tanggal.strftime('%d %B %Y') }}</td>
              <td>{{ row.keterangan }}</td>
              <td>{{ "{:,.0f}".format(row.masuk) if row.masuk else '' }}</td>
              <td>{{ "{:,.0f}".format(row.keluar) if row.keluar else '' }}</td>
              <td><strong>{{ "{:,.0f}".format(row.saldo) }}</strong></td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <div style="display:flex;justify-content:space-between;margin-top:12px;color:var(--muted);font-size:0.9rem">
        <div id="rowsCount">Menampilkan {{ data|length }} baris</div>
        <div>Terakhir diperbarui: <strong id="lastUpdate">{{ datetime.utcnow().strftime('%d %B %Y %H:%M') }}</strong></div>
      </div>

      <div class="ttd-section">
        <div class="ttd">
          <p>Ketua Posyandu</p>
          <img src="/static/img/ketua_posyandu.jpeg" alt="">
          <h4>Nia Suciyati</h4>
        </div>
        <div class="ttd">
          <p>Mengetahui, Ketua PKK RW 14</p>
          <img src="/static/img/ketua_pkk.jpeg" alt="">
          <h4>Yati Yuliawati</h4>
        </div>
        <div class="ttd">
          <p>Bendahara</p>
          <img src="/static/img/bendahara.jpeg" alt="">
          <h4>Ani Hanifah</h4>
        </div>
      </div>
    </section>
  </main>

  <script>
    function parseNum(txt){return Number(String(txt).replace(/[^\d]/g,''))||0}
    function formatRp(n){return "Rp "+n.toLocaleString("id-ID")}
    function recalc(){
      let rows=[...document.querySelectorAll("#laporanTable tbody tr")];
      let masuk=0, keluar=0;
      rows.forEach(r=>{
        masuk+=parseNum(r.children[3].innerText);
        keluar+=parseNum(r.children[4].innerText);
      });
      document.getElementById("totalMasuk").textContent=formatRp(masuk);
      document.getElementById("totalKeluar").textContent=formatRp(keluar);
      document.getElementById("rowsCount").textContent=`Menampilkan ${rows.length} baris`;
      document.getElementById("lastUpdate").textContent=new Date().toLocaleString("id-ID");
    }
    document.getElementById("search").addEventListener("input",e=>{
      const q=e.target.value.toLowerCase();
      document.querySelectorAll("#laporanTable tbody tr").forEach(tr=>{
        tr.style.display=tr.innerText.toLowerCase().includes(q)?"":"none";
      });
      const all=[...document.querySelectorAll("#laporanTable tbody tr")];
      const visible=all.filter(r=>r.style.display!=="none").length;
      document.getElementById("rowsCount").textContent=`Menampilkan ${visible} dari ${all.length} baris`;
    });
    document.addEventListener("DOMContentLoaded",recalc);
  </script>
</body>
</html>
